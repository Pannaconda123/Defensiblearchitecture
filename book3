	1. NSM - security monitoring - pg 25
a. NIDS, PCAPS, Vulnerability identification, and asset discovery.
	2. Alert driven workflow vs data-driven workflow - pg 26
		a. NSM uses data based on signature based alerts 
		b. NSM provides additional data needed for further identify enrichment during threat hunts'
	3. Switch SPAN ports
		a. Allows for sniffing traffic
	4. Network Taps pg 30-31
		a. Taps will forward all frames to the monitoring ports
		b. Can often represent a single point of failure
	5.  Sensor Network monitoring placement pg 32
		a. Sensors between the perim and internet provides external attack visibility.
		b. Internal sensors provides outbound traffic visibilty (more important) and lateral movement
	6. Security onion pg 33
		a. Linux distro
		b. Contains zeek, snort, suricata, full PCAP storage
		c. Considered the blue team distro
	7. Behavioral NSM with Zeek PG 35
		a. Enhances network visibility beyond traditional signature detection
		b. IDS ++
		c. Provides full context of all activity related to network events
		d. Used to be named bro
	8. Zeek pg 36
		a. Both an ids and NSM
		b. Built for creating logs from network trafic
		c. Requires sensor placement
		d. Provides logs for all types of data in the pipe
	9. Power of network metadata
		a. IDS signatures are for known bad
* Metadata is simply data
		b. Allows for learning the environment
		• Abnormal events
		• Unauthorized assets
		• Vulnerable or misconfigured assets
	10. Generic network traffic analysis architecture pg 39
		a. NTA architecture should support use cases such as : C2 and unknown bad, Ransomware, Exfiltration, lateral movement by the attacker, compromised devices, internal access abuse, other network misconfig
	11. Operationalizing network logs ( pg 40)
		a. Decentralized bia scripts
		• Allows data manipulation
		• Custom alerting
		• Before and after compare
		• Apply data science
		b. Centralized via siem
		• Up front labor and fiscal investment
		• Built for data manipulation
		• Automated alerting
		• Data science hooks built in 
		• Correlate disparate data
		c. Zeek and suricate require finding a method to analyze the data en-masse. Scripting works but requires scripting knowledge and methods for analyzing massive amounts of data
	12. Security onion network + endpoint visibility PG 41
		a. ELK stack allows for easy pivoting between host and network data
	13. 100G intrusion detection with zeek
		a. 1000gbps has become more prevalent. Traffic volume has not always kept pace
		b. Berkeley lab cyber security team brought their monitoing system online in Jan 2015
	14. Zeek Architecture PG 43
		a. Not multithreaded, but its possible to scale by spreading the workload across many hosts
		b. 1 core per 250mbps of traffic
	15. Zeek architecture pt 2 PG 45
		a. Architected into two parts : event engine, script interpreter
		b. Event engine reduces the incoming packet stream into a series of higher-level events
		c. Script interpreter executes a set of event handlers. The scripts express a site's security policy.
	16. Minimal starting config for Zeek PG 46
		a. $prefix/etc/nod.cfg set the right interface to monitor
		b. Networks.cfg add the networks that bro will consider local
		c. Broctl.cfg change mailTO email address to the recipient and LogRotationInterval to the archival frequency desired
	17. Zeek cluster config, Node.cfg
		a. Edit node.cfg on the "manager host"
		b. Cluster configs will contain stanzas just like splunk has
[logger]
type=logger
host=10.0.0.10
	18. Zeek as a Comman line utility PG 49
		a. Live or offline traffic can be done from CLI
		• Bro -I <network interface> < list of scripts>
		• Bro -r <pcap file>
		• Ex: bro -r /labs/3.2/capture.pcap/labs/3.2/analysis.bro
	19. Loading zeek scripts PG 50 
		a. Most if not all outputs generated by zeek is a zeek script. 
		b. The scripts notify zeek that should there be an event, the ingest the inforamtion about the connection and perform a function
	20. Running zeek inside a docker container PG 55
		a. Logs are kept persistent by mounting a directory from the host filesystem into the container
		b. The container will use the host's networking stack
		c. Large container based deployments can be managed with kubernetes
	21. Zeek use cases: spotting the C2
		a. Strings of 34-43 characters can be a symptom of domain generation algorithms
	22. Zeek use cases: TLS magic with JA3
		a. Technique for creating SSL fingerprints from pre-encryption handshakes
		b. Self-signed certificates often have JA3 fingerprints
		c. Bringing these values in will allow for hunting for unusual JA3 fingerprints
	23. Zeek use cases: TLS magic with JA3
		a. Using bro package manager run : bto-pkg install ja3
	24. Suricata & TLS magic with JA3
		a. Suricata can also make good use of network metadata: one  example is dridex ssl client hello
	25. Zeek use case : Detect beaconing with Flare & RITA
		a. Flare analyzes zeek or suricata flows inside an elastic stack to identfy c2 beacons
		b. Real Intelligence Threat analytics (RITA) can ingest zeek logs to detect beaconing, DNS tunnels and query block lists
	26. NIDS network intrusion detection PG 65
		a. Signature based
		b. Anomaly based
		c. Protocol based
	27. Signature-based detection
		a. Power of signature rules is catching known C2, Trojan backdoors, policy violations, exploitation attempts, network scanning, indicator of compromise activity, odd protocol use
	28. Snort
		a. The most common IDS, has many commercial solutions
		b. Rule and rule format work on most other IDS solutions
		c. Built-in protocol analysis
	29. Snort rule header PG 68
		a. Snort rule header has seven parts: actions, protocols, source IP, source port, direction, destination ip, destination port
	30. Variables PG 69
		a. Snort rules support and use variable
			i. Declared with ipvar and portvar
		b. Most common variables are home_net and External_net
		c. Not limited to DNS_servers, http_servers, and SQL_servers
	31. Snort rule options
		a. Msg, content, metadata, classtype, sid
	32. Gid PG 71
		a. Gid specifies what generates an event
			i.  1- General rule
			ii. 100+ preprocessors and decoders
			iii. 116 - Snort decoder
			iv. 119 - HTTP inspect 
			v. 123 - Frag3 preprocessor
			vi. 129 - stream preprocessor
		b. Snort comes with built--in decode processes for payload
	33. Suricata PG 72
		a. Open-source IDS/NSM
		b. Developed by open information security foundation
		c. Generates alerts and network metadata logs
		d. Huge reason for support is application identification
	34. Metadata logging
		a. Suricata creates network logs
		b. NSM provides alerts plus context
		c. An ids generates alerts, while NSM provides network logs, url's, bidirectional flow, and more
	35. Rules, rules, and more rules PG 74
		a. Default systems often have over 10k rules, commercial products can have over 50K
		b. Maintaining these rules is a major task
			i. Too many rules lead to performance issues
			ii. False positive can cause a DOS
			iii. Too few rules mean no visibility
		c. Consider alert fatigue, but also make sure that a real attack is not missed
	36. Pulledpork PG 75
		a. Scripted rule management
		b. Enabledsid.conf - forces a rule to be enabled
		c. Dropsid.conf - sets rules to drop (used in ips mode)
		d. Disabledsid.conf - disabled rules on sesnsor
		e. Modifysid.conf - Modifies rules with find/replace
	37. Thresholds.conf PG 76
		a. Flowbits cannot be disabled by disabledsid.conf
			i. Thresholds.conf is used to suppress rules
		b. Flowbits - used by an IDS to share the state of a connection flow with another rule, and allows linking multiple rules together
	38. Default config
		a. Expect tons of false positives
		b. Rules are not custom
		c. Customizing IDS alerts allows adjustments of rule priorities, allow lists, custom event alerts
	39. Rule priorities PG 78
		a. IDS rule properties default to classtype
			i. Example : misc-activity is set to 3
		b. Alert defaults to low priority
		c. Scripting alerts using pulledport or another program can greatly aid in reprioritization
			i. Modifysid.conf can be used to dynamically change the priority on rules based on regex or sid numbers
	40. Whitecap rules PG 79
		a. NIDS signature is primarily block listing, but can also be used for passing traffic
		b. Whitecap rules will allow for ignoring expected traffic, but alerting on everything else
	41. Catching the point PG 80
		a. Attack methodology often requires internal pivoting
		b. Tapping the network is a simple process, which will allow visibility onto this lateral movement when it occurs
	42. Alert investigation PG 81
		a. IDS/IPS solutions have investigation workflows
		b. Sec Onion uses Sguil squert and kibana
	43. SIEM integration  - Kibana
		a. Integrating network logs with a SIEM allows for simpler workflow orchestration
	44. Evebox PG 83
		a. Designed for suricata
			i. Provides a web-based alert and event management
			ii. Uses alerts and metadata logs
	45. NSM review PG 84
		a. NSM can perform the following
			i. Rules to allow list traffic, find pivoting, and identify C2
			ii. Passive network log generation
			iii. Packet capturing
			iv. Alert investigation interfaces
	46. Payload inspection issues PG 89
		a. Layer-7 payload inspection works for AV, IPS/IDS, URL filtering
		b. Signature-based detection will often miss
			i. Tools can modify paylods to evade AV and IDS/IPS
			ii. Auctioned domains or new domains can bypass URL filters
	47. Malware detonation PG 90
		a. Behavior monitoring is alternative to signatures
		b. Involves running and analyzing a special system
	48. Detonation workflow PG 91
		a. High-level breakdown of how malwre analysis works
		b. File or URL is submitted > AV and reputation databases run check > run file or access URL using a virtual system or software
	49. Behavior analysis PG 92
		a. Registry key monitoring, dropping files, persistence mechanisms, network access, memory analysis, process analysis.
	50. Cloud vs on-premis
		a. Malware detonation comes in two types
			i. Cloud -  often used in conjunction with NGFW
				1) Issues : cannot block initial access, may leak private or sensitive data to cloud service
				2) May leak private or sensitive data to the cloud service
				3) Benefit : Provides shared intelligence
			ii. On-premise - Typically a dedicated box of VM
				1) Costly and requires additional labor
				2) Typically provides additional utility and options
				3) Inline blocking
		b. Sensitive documents containing proprietary data or otherwise can cause an unintended data breach
	51. Inline malware detonation PG 94
		a. Sandbox analysis systems can sit inline
		b. Not real-time, sandboxing a file takes time to process, user waits for the file to be analyzed
		c. Setting a delay is option, which will allow the file to run even if malicious
	52. Alternative submission methods PG 95
		a. Systems support manual and automated submisison
		b. Many points of integration through web or API: quarantined files, files or links on USB drives, testing of URLs/Files from IDS alerts, network extraction of specific file types
	53. Securing the detonation PG 96
		a. Malware detonation box needs to be secured
		b. Place a separate firewall for the detonation box
			i. Consider a TAP for further analysis
			ii. Consider a separate NAT to a different external IP
			iii. Consider risk of malware attacking other orgs
	54. Zeek file extraction PG 97
		a. Zeek can automatic extract files
		b. File extraction and api submission allows for full automation
		c. Detonation devices keep a record of each analysis
		d. Zeek can perform file carving : file extracted from the network and transferred automatically
	55. App any run PG 98
		a. Free malware detonation
		b. Ad hoc triage analysis
		c. Safer way to launch potentially malicious URLs and files
	56. Cuckoo sandbox PG 99
		a. Malwr.com has multiple restrictions ( file size, types, data)
		b. Cuckoo is open source
			i. Supports advanced memory, process, and traffic analysis
			ii. Strong documentation
			iii. Yara IOC support
	57. Sandbox virtual machines PG 100
		a. Commercial solutions use pre-built VMs with license requirements
		b. Customization of VM allows for better use  cases
			i. Start with gold image
			ii. Increase logging
			iii. Add software and tools
	58. Network access considerations PG 101
		a. Malware can react differently according to network design
			i. No routing : can hide , may not execute properly, low risk, stops separate attacks
			ii. Internet access: downloads tools, allows c2 communication, can move laterally, able to see full behavior can limit external access if needed
			iii. VPN/ TOR : changes behavior based on geolocation, can find malware with specific behavior, and identify target of the malware
	59. Virtual machine identification PG 102
		a. Malware attempts to hide from malware detonation
			i. Simple checks include : mac address, hard drive space, memory resources, vm guest software detection, drivers and BIOS, emulation software
	60. Virtual machine masking PG 103
		a. Antivmdetection and vmcloak can hide virtual status 
	61. Integration with other systems PG 104
		a. NGFW AV - bad file hashes
		b. NGFW URL Filtering - add and block domains
		c. Endpoint av - block hashes
		d. Allow lists - add and block bad file hashes
	62. Malware detonation overview PG 105
		a. Consider malware detonation for 
			i. Inline prevention
			ii. Automatic file/URL submission
			iii. Discovering new signatures
			iv. Integrating behavior with signature based systems
	63. Remote access PG 108
		a. Multiple protocols for remote access : VPN, terminal services/ virtual desktop, ssh, rdp-ssh, remote access
	64. TLS-based VPN PG 109
		a. Modern vpns use TLS
			i. AES256 supported
			ii. Fast performance due to tls
			iii. UDP or TCP support
			iv. Authentication support
			v. Client or browser integration
		b. Post-authentication checks
	65. Block remote access 
		a. Unauthorized remote programs need to be blocked
		b. Use app control, FQDN blocking, or sinkholing
		c. Expect to find many remote access methods
			i. Often found through shadow IT, policy violations, personal programs
	66. Remote access risk tolerance
		a. High-risk tolerance : Remote desktop over the internet, remote access via teamviewer, gotomypc, logmein, PPTP
		b. Medium-Risk tolerance: SSL/Ipsec VPN username/password, ssh with un and pw
		c. Low-risk tolerance: remote access with MFA and allow lists
	67. Remote access risks PG 113
		a. Remote access servers are often targets for server-side attacks 
		b. Remote authentication needs passwords
	68. Architecture fail of passwords PG 114
		a. Dictionary attack - attacker uses a list of passwords, tries all combinations, may get blocked after x failed attempts
		b. Password spraying - same but one try per user, might get blocked by source ip after x failed attempts
		c. Botnet tunneling - same as 1 or 2 but source changes per attempt
	69. Proxycannon PG 115
		a. Emulates a private botnet using amazon EC2
			i. Automation script to deploy new amazon instances
			ii. Supports rotating instances every x time period
			iii. Tunnels all traffic through aws instances
			iv. Helps indentify detection/ prevention/ response abilities
	70. Remote desktop on HTML5 with Apache Guacamole
		a. Guacamole is an opensource clientless RDP, ssh , and vnc platform
		b. Supports RADIUS, LDAP, 2FA
		c. SSL/TLS termination can be achieved with Ngnix in front of it
	71. Multifactor authentication PG 117
		a. Something you have, something you know, something you are
	72. HMAC-Based and Time-Based One-Time passwords HOTP and TOTP PG 118
		a. HOTP uses a secret key and counter to generate HMAC
		b. Counter is an 8-byte value that changes with each use
		c. TOTP involves generating a password that rotates based on time
			i. Typically rotates every 30-60
			ii. Algorithm uses time since epoch and a shared secret key
			iii. Same as HOTP but uses time for counter
	73. Google Auth PG 119
		a. Free multifactor for all
			i. Requires google account
		b. Online documentation allows for integration with systems
			i. Windows - WinAuth agent
			ii. Linux - Requires google authenticator PAM module
			iii. VPN Solution - Most vendors support integration
			iv. Apache Guacamole
	74. Split-tunneling vs Full-tunneling
		a. Split-tunnel - Only specific subnets are routed over VPN
			i. Allows local traffic
			ii. Lowers bandwidth consumption
			iii. Increases the likelihood of external infection
		b. Full-Tunnel - All traffic must traverse VPN
			i. Higher bandwidth consumption (central point of internet traffic)
			ii. All traffic funnels through centralized security solutions
			iii. Acts as if the system were plugged into the corp network
			iv. Cannot access local resources such as IP printers
	75. Always on VPN
		a. One approach is to use full-tunnel mode with always-on VPN clients
			i. Allows mobile devices to be handled similarly to desktops
		b. Requires storing password or certificate on each system
			i. As soon as internet access is available vpn connects home
			ii. Deployment can be automated at build time or through deployment software
			iii. Endpoint is restricted from disconnecting from VPN
			iv. Compression and client-based WAN optimization can limit bandwidth consumed at the central location
	76. Compression on WAN optimization PG 122
		a. Includes download time, Total file size, and Total Packets
	77. Windows always on VPN and DirectAccess PG 123
		a. Windows has built-in VPN capabilities pre-installed
			i. Windows 7 enterprise and later supports windows DirectAccess
				1) Uses automatic split-tunneling when accessing corporate resources
				2) Supports always on mutual auth with machine certifications
		b. Windows 10 anniversary update supports always on
			i. Can vpn with split or full-tunnel when internet access is available
			ii. Integrates with azure MFA and windows hello
			iii. Connection can be triggered based on app launch
	78. Post-authentication checks
		a. Many vpn clients have post-authentication checks
		b. Vulnerability scan with automated remediation
		c. Patch verificiation with automated remediation
		d. Custom scripts (looking for running processes)
	79. Modern alternatives to VPN - ZTNA and SDP PG 125
		a. VPN provides access to a network- usually overly permissive
		b. Zero trust network access (ZTNA) or Software Defined Perimiter (SDP) enforces custom policy for each device. Each connection is treated as untrusted and verified continuously
		c. Goal should be to move to zero-trust
	80. Controlled Network authentication PG 126
		a. Remote access is more than simply external access
			i. Internal to internal access needs to be controlled
			ii. Privileged access on the network is important
			iii. Constructing the attack paths can be done using tools such as BloodHound
		b. Multiple options for controlls remote access
			i. Administrative workstations, jump boxes, IAM.
		c. Identify group nesting, local admin rights, active user sessions, ACL's, GPO's to understand the attack paths as a defender
	81. Clean source principle and AD management PG 127
		a. CSP states that a system can be dependent on a higher trust system but not on a lower trust system
		b. You should identify all object's security dependencies and make sure that they are as trusted as the object they are trying to secure
		c. CSP applies to cases where the need to secure sensitive objects, such as DB servers, network infrastructure and DC's
	82. Comman attacks with lateral movement PG 128
		a. Primary issue is credential theft and re-use
			i. Malware is often capable of stealing credentials
			ii. Can be stolen from disk or in RAM
		b. Cleartext pw retrieval via : mimikatz, LSA secrets, saved passwords
	83. Administrative workstations pg 129
		a. Administrative accounts have the highest risk, as is the risk of credential theft
		b. Recommend using administrative workstation design
	84. Jump box connection options pg 130
		a. RDP is used for web and internet
			i. Limits compromise to RDP server
			ii. Limits theft to the standard account
		b. Virtual desktop infrastructure 
			i. Same as RDP
			ii. Limits compromise to an individual user or endpoint
	85. Local jump box pg 131
		a. Possible to localize jump box with virtualization
			i. Risk of vm escape
		b. Physical host needs to be secured OS
			i. Productivity apps should be in the vm
			ii. Compromise of host will mean the vm is compromised as well
	86. Controlled Authentication PG 132
		a. Purposely built remote access allows prevention and detection
		b. Ensure network active from productivity systems are considered
		c. One example would be to limit the authentication of a domain admin to only one jump box or subnets
	87. Identity access management PG 133
		a. IAM is often used for federated authentication and SSO
			i. Allows centralized auth
			ii. Allows on login to work with multiple systems
				1) No timeouts can be risky on critical apps
			iii. Solutions can also be used for custom authentication workflows
		b. IAM controls how, when and where authentication is handled for enterprise assets
	88. Remote access review PG 134
		a. Limitations of admin privs
		b. Directional flow of authentication
		c. Enforcing mfa
		d. Implementation should provide prevention capabilities
		e. Grants immense capabalities
	89. DDOS PG 137
		a. IOT devices are often insecure
		b. Large number of devices in botnet = DDOS platform
		c. Specific industries are routinely targeted, yet DDOS can target any org
	90. Mirai PG 138
		a. Brian krebs, was the victim of one of the largest DDOS attacks ever
		b. Came from Mirai btnet
		c. Mirai scanned for default creds on IOT devices
			i. Ignores specific IP subnets
			ii. Mostly CCTV cameras but also DVR and routers
			iii. Distributed malware based on the device identification
	91. Types of DDOS attacks PG139
		a. Volumetric : flood of packets
		b. Protocol: abuse protocols to cause timeouts
		c. App layer -  Exploit flows in applications to crash the system
	92. Volumetric attacks PG 140
		a. Goal of volumetric attack is to saturate the victims pipe
			i. An organization might have 100mbps
			ii. Botnets send lots of often spoofed data
		b. Data does not need to be legitimate
	93. Internet service provider DDOS protection PG 141
		a. On Prem solutions cannot mitigate volumetric attacks
			i. Once the bandwidth is depleted then the org loses
		b. ISP's can help mitigate the attack
			i. DDOS protection might be included in the service contract
			Many ISP's do not have mature DDOS services
	94. Protocol attacks PG 142
		a. Possible to take advantage of everyday protocols like TCP
			i. Abusing syn flood attacks as part of the TCP handshaker
		b. Attacker spoofs multiple syn packets
			i. Server replies with syn-ack
			ii. Server waits for expected ack
			iii. Attacker does not respond or never receives syn-ack
			iv. Too many half-open connections
			v. Legit connections cannot be made
	95. Syn flood protections PG 143
		a. Tuning systems can help address syn floods
			i. Increase the backlog queue to support more half-open connections
			ii. Shrink duration of half-open connections
				1) On Linux : /etc/sysctl.conf: net.ipv4.tcp_syncookies =1 , 
net.ipv4.tcp_max_syn_backlog=2048
				2) Windows Vista and later dynamically sets syn protection
	96. Slowloris pg 145
		a. Slowloris is another resource exhaustion attack
			i. Sends partial http requests
			ii. Server opens a thread for each request
	97. HTTP DDOS mitigation PG 146
		a. Tune web server settings
			i. Max number of clients
			ii. Limit max numbers of connections per source
			iii. Set request timeouts
	98. Application attacks PG 147
		a. Apps can be exploited and used for DDOS
		b. Attacker sends spoofed dns to open dns resolver servers
			i. Spoofed ip is set to an ip of the victim
			ii. ENDSo DNS protocol extension used to allow large DNS messages
			iii. DNS query type to ANY to retrieve all records
	99. Application DDOS mitigation PG 148
		a. If exploit was specific to internal apps, then patch
			i. Otherwise with IPS, NGFW, and/or reverse proxy
			ii. Reverse proxy may be able to implement virtual patch
			iii. Many DDOS attacks involve external systems
				1) DNS amplification abuses DNS recursion
					a) Fix is to disable recursion
			iv. NTP amplification abuses NTP commands like monlist
				1) Disable monlist, but often NTP is not yours
		b. Control DNS and NTP internally if possible
	100. DDOS scrubbing PG 149
		a. Commercial solutions offer DDOS scrubbing
		b. Cloud service integration is possible at enterprise level as well
			i. Consists of BGP or GRE tunnel integration
			ii. Can be dynamic but goal is to route this traffic to the vendor
	101. On-Premise DDOS Mitigation PG 150
		a. DDOS vendor or ISP is required for bandwidth attacks
			i. This transfers the attack from your pipe to the vendor
		b. On-prem solutions can help with basic DDOS attacks
			i. Firewalls - reputation filters, ips signatures, DDOS protection
			ii. DDOS can knock over NGFW with default settings
		c. Reverse proxies (F5, web app firewall)
		d. Load balancers
	102. DDOS review PG 151
		a. DDOS needs assessed in your org risk strategy
			i. Cloud or ISP needs to help for bandwidth attacks
			ii. Protection can be wholistic or per key service
		b. On Prem solutions need to be tuned
			i. All existing equipment
			ii. FW settings need to be tuned accordingly
			iii. OS and apps can be tweaked to mitigate DDOS atttempts
	103. Network Encryption PG 154
		a. Prevention/detection techniques require visibility
		b. Encryption hides payload data
		c. Encrypted data only readable by the endpoint
		d. Encryption can be used to secure traffic or prevent malware's detection
	104. Secure transmission PG 155
		a. Network encryption is designed to secure communication
		b. Uses hierarchical trust
			i. A trusts C because it is signed by Server D
	105. Encryption issues PG 156
		a. Malware offten uses encryption
			i. Phishing sites are encrypted often
			ii. Malware uses TLS to communicate to C2
		b. Encryption breaks current investments
			i. Prevents DLP visibility
			ii. Prevents Malware analysis
			iii. Prevents Application visibility in IDS/NSM
	106. Leveraging encryption PG 157
		a. Industry push is to encrypt everything. This increases risk
		b. Encryption considerations
			i. Is end-to-end encryption necessary
			ii. Is the encryption implemented securely
			iii. Is inspection allowed
			iv. Is a strong encryption enforced
	107. Lets Encrypt PG 158
		a. Internet is moving toward 100% encryption
		b. Let's encrypt is a free automated and open CA
			i. Based on non-profit crowdfunding
			ii. Provides automated cert issuance and renewals
				1) Certbot automates certs and hardens config
		c. Malware is  already using let's encrypt
	108. HTTP strict transport security HSTS PG 159
		a. Web sites support https and HTTPS
			i. Done for performance but affects security
		b. Switching between http and https is insecure
			i. Info leakage (cookies, sessions) and mitm
		c. HSTS fixes the above issues
			i. Upgrades http links to https automatically
			ii. Disables ability to click to invalid certs
			iii. Removes downgradable http sites
	109. SSLstrip PG 160
		a. Requires victim machine to be caught in mitm
		b. Then downgrades on https
	110. HSTS Preloading PG161
		a. Major browsers support HSTS
		b. HSTS preload lists enforce HTTPS
		c. Requirements for HSTS preloading
	111. Certificate Transparency Monitoring PG 162
		a. Certificate authorities are expected to generate public logs
			i. Means a public log is available per certificate issued
			ii. The goal is no require support for certificcate transparency
		b. Provides near real-time notification of new certificates
			i. Vendors offer commercial integration and monitoring
			ii. Facebook provides free certiicate transparency monitoring
	112. Expect-CT PG 163
		a. Expect-CT operationalizes certificate transparency
			i. Expect-CT reports and forces browser to validate a transparency log exists
			ii. Set as an HTTP header
	113. Certificate authority Authorization (CAA) PG 164
		a. Certificates should only generated by trusted CA's
		b. Domain validation authorizes specific CA's for domain
		c. CAA requires a simple DNS record to operate (RFC 6844)
	114. Crypto Suite Support PG 165
		a. Different devices/ software support different algorithms
			i. Cipher suites are the encryption algorithms supported
			ii. Weak cipher can be exploited by adversaries
			iii. Malware may use abnormal or old ciphers
		b. Modern operating systems allow selections of cipher
			i. Windows via registry keys and linux via configuration files
	115. Qualys SSL Labs PG 166
		a. Web servers need to be hardened for proper encryption
			i. Disable SSL support
			ii. Fine tune cipher suites
			iii. Enable proper headers
				1) HSTS HPKP
	116. SSL/TLS Passive Decryption PG 167
		a. Proper Certificate establishment and use is important
		b. Depending on the encryption method, decryption is possible
			i. PCAP can be decrypted with Wireshark
			ii. Tools like viewssld can decrypt on the fly
		c. Passive sniffing has a high fail rate for decryption
			i. Perfect forward secrecy PFS breaks passive decryption
			ii. Many internet sites use PFS
	117. Perfect Forward secrecy (PFS) PG 168
		a. PFS negotiates an encryption key using Diffie-Hellman
			i. Symmetric key changes per client/server session
			ii. Even if the key is compromised prior session are unlikely to be decrypted
	118. SSL inspection PG 169
		a. NGFW or web proxies support ssl inpection
			i. Security device acts as a trusted CA to internal devices
				1) Issues certificates per site accessed
				2) Fixes visibility issues such as PFS blindness
				3) Requires systems to trust security device as CA
	119. SSL decrypt Mirror Port PG 170
		a. Modern devices with SSL inspection also support SSL decrypt mirroring
		b. Decrypted packets are mirrored out an interface
		c. Decrypted traffic shows with original port such as 443
			i. Reflects decrypted data
			ii. IDS should include 443 in HTTP_PORTS
	120. Network encryption Review PG 172
		a. Encryption plays a pivotal part of any architecture
		b. Network encryption can be supplemented with
			i. HSTS, HSTS preloading, CAA, Certificate transparency
			ii. Hardening of Cipher Suites
		c. Remember visibility is critical
	
	
	
	
		
		
	
